<script>
import TranslationsHelper from 'js/mixins/translations-helper';
import InventorySalesData from 'js/mixins/inventory-sales-data';
import DataTablePager from 'js/components/UI/DataTablePager';
import { mapGetters } from 'vuex';
import moment from 'moment';
import 'moment-timezone';

export default {
    name: 'variant-content-sales-tab',
    components: {
        DataTablePager
    },
    mixins: [InventorySalesData, TranslationsHelper],
    data() {
        return {
            locale: 'America/Chicago'
        };
    },
    computed: {
        ...mapGetters([
            'salesData'
        ]),
        pageGroup() {
            const begin = this.getPageBeginning(this.currentPage);
            const end = this.getPageEnd(this.pagedDistributors, this.salesData.SalesWeekTotalsByDistributor);
            return this.replaceTranslationPlaceholder(this.translations.PageGroup, begin, end, this.salesData.SalesWeekTotalsByDistributor.length);
        },
        pagedDistributors() {
            return this.paginateArray(this.salesData.SalesWeekTotalsByDistributor, 10);
        },
        startOfLastWeek() {
            return moment(this.salesData.EndDate).tz(this.locale).subtract(1, 'weeks').add(1, 'days')
                .format('MMM DD');
        },
        endOfLastWeek() {
            return moment(this.salesData.EndDate).tz(this.locale).subtract(1, 'weeks').add(7, 'days')
                .format('MMM DD');
        },
        startOf2WeeksAgo() {
            return moment(this.salesData.EndDate).tz(this.locale).subtract(2, 'weeks').add(1, 'days')
                .format('MMM DD');
        },
        endOf2WeeksAgo() {
            return moment(this.salesData.EndDate).tz(this.locale).subtract(2, 'weeks').add(7, 'days')
                .format('MMM DD');
        },
        startOf3WeeksAgo() {
            return moment(this.salesData.EndDate).tz(this.locale).subtract(3, 'weeks').add(1, 'days')
                .format('MMM DD');
        },
        endOf3WeeksAgo() {
            return moment(this.salesData.EndDate).tz(this.locale).subtract(3, 'weeks').add(7, 'days')
                .format('MMM DD');
        },
        startOf4WeeksAgo() {
            return moment(this.salesData.EndDate).tz(this.locale).subtract(4, 'weeks').add(1, 'days')
                .format('MMM DD');
        },
        endOf4WeeksAgo() {
            return moment(this.salesData.EndDate).tz(this.locale).subtract(4, 'weeks').add(7, 'days')
                .format('MMM DD');
        },
        startOf8WeeksAgo() {
            return moment(this.salesData.EndDate).tz(this.locale).subtract(8, 'weeks').add(1, 'days')
                .format('MMM DD');
        },
        endOf8WeeksAgo() {
            return moment(this.salesData.EndDate).tz(this.locale).format('MMM DD');
        }
    },
    methods: {
        // Shared Vue instance in js/mixins/inventory-sales-data
    }
};
</script>